@model IEnumerable<DATN.MVC.Areas.Admin.Models.AdminPost.Response.ViewPostResponse_Res>

<style>
    /* Thiết lập background của modal */
    .modal-content {
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.15);
        padding: 20px;
    }

    /* Căn chỉnh tiêu đề modal */
    .modal-header {
        border-bottom: 1px solid #ddd;
        padding-bottom: 10px;
    }

    .modal-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #333;
    }

    /* Đóng nút trong header */
    .btn-close {
        background-color: transparent;
        border: none;
        font-size: 1.25rem;
        color: #888;
    }

        .btn-close:hover {
            color: #333;
        }

    /* Cải thiện khoảng cách và kiểu dáng cho form */
    .modal-body {
        padding-top: 20px;
    }

    .edit-post-status-form-group {
        margin-bottom: 20px;
    }

    .edit-post-status-label {
        font-weight: 600;
        color: #444;
        display: block;
        margin-bottom: 8px;
    }

    .edit-post-status-input, .edit-post-status-select {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 6px;
        background-color: #f9f9f9;
        transition: border-color 0.3s ease;
    }

        .edit-post-status-input:focus, .edit-post-status-select:focus {
            border-color: #007bff;
            outline: none;
        }

    /* Nút submit */
    .edit-post-status-btn {
        width: 100%;
        background-color: #007bff;
        color: #fff;
        padding: 14px;
        font-size: 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

        .edit-post-status-btn:hover {
            background-color: #0056b3;
        }

    /* Hiệu ứng cho modal khi mở */
    .modal.fade .modal-dialog {
        transform: translate(0, -50px);
        transition: transform 0.3s ease-out;
    }

    .modal.show .modal-dialog {
        transform: translate(0, 0);
    }

    /* Thêm margin-bottom cho modal */
    .modal-dialog {
        max-width: 500px;
        margin-top: 50px;
    }

</style>
<h2>Danh Sách Bài Đăng</h2>
<div class="card mb-4">
    <div class="card-header">
        <i class="fas fa-table me-1"></i>
        Danh Sách Bài Đăng
    </div>
    <div class="card-body">
        <table id="datatablesPost" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Người Tạo</th>
                    <th>Hình Ảnh</th>
                    <th>Trạng Thái</th>
                    <th>Hành Động</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Id</td>
                        <td>@item.UserId</td>
                        <td>
                            <img src="@item.Image" alt="Hình ảnh bài đăng" style="max-width: 100px; max-height: 100px;" />
                        </td>
                        <td>@(item.IsActived ? "Hoạt động" : "Không hoạt động")</td>
                        <td>
                            <!-- Nút chỉnh sửa sử dụng Modal -->
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editPostStatusModal"
                                    data-id="@item.Id" data-status="@item.IsActived">
                                Chỉnh sửa
                            </button>
                            <button type="button" class="btn btn-danger" onclick="deletePost(@item.Id)">Xóa</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Modal chỉnh sửa trạng thái -->
<div class="modal fade" id="editPostStatusModal" tabindex="-1" aria-labelledby="editPostStatusModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPostStatusModalLabel">Chỉnh sửa trạng thái bài đăng</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" asp-action="UpdateStatusPost" asp-controller="AdminPost">
                    <div class="edit-post-status-form-group">
                        <label for="PostId" class="edit-post-status-label">ID Bài viết:</label>
                        <input type="text" id="PostId" name="PostId" class="edit-post-status-input" readonly />
                    </div>

                    <div class="edit-post-status-form-group">
                        <label for="IsActived" class="edit-post-status-label">Trạng thái bài viết:</label>
                        <select id="IsActived" name="IsActived" class="edit-post-status-select">
                            <option value="true">Hoạt động</option>
                            <option value="false">Không hoạt động</option>
                        </select>
                    </div>

                    <button type="submit" class="edit-post-status-btn">Cập nhật trạng thái</button>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/admin/js/datatable-Post.js"></script>

    <script>
        // Script để xử lý việc nạp thông tin vào modal khi người dùng nhấn nút chỉnh sửa
        const editButtons = document.querySelectorAll('[data-bs-toggle="modal"]');
        editButtons.forEach(button => {
            button.addEventListener('click', () => {
                const postId = button.getAttribute('data-id');
                const postStatus = button.getAttribute('data-status');

                // Cập nhật giá trị vào trong modal
                document.getElementById('PostId').value = postId;
                document.getElementById('IsActived').value = postStatus === 'true' ? 'true' : 'false';
            });
        });
    </script>
}
