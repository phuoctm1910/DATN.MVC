@model IEnumerable<DATN.MVC.Areas.Admin.Models.AdminPost.Response.ViewPostResponse_Res>


<h2>Danh Sách Bài Đăng</h2>
<div class="card mb-4">
    <div class="card-header">
        <i class="fas fa-table me-1"></i>
        Danh Sách Bài Đăng
    </div>
    <div class="card-body">
        <table id="datatablesPost" class="table table-striped table-bordered">
            <thead >
                <tr>
                    <th class="text-center align-middle">Người Tạo</th>
                    <th class="text-center align-middle">Hình Ảnh</th>
                    <th class="text-center align-middle">Trạng Thái</th>
                    <th class="text-center align-middle">Ngày Tạo</th>
                    <th class="text-center align-middle">Ngày Cập Nhật</th>
                    <th class="text-center align-middle">Hành Động</th>
                </tr>
            </thead>
            <tbody >
                @foreach (var item in Model)
                {
                    <tr style="text-align: center; vertical-align:middle">
                        <td>@item.FullName</td> <!-- Hiển thị tên người tạo -->
                        <td>
                            <img src="@item.Image" alt="Hình ảnh bài đăng" style="max-width: 100px; max-height: 100px;" />
                        </td>
                        <td>@(item.IsActived ? "Hoạt động" : "Không hoạt động")</td>
                        <td>@item.CreatedDateTime.ToString("dd/MM/yyyy HH:mm")</td> <!-- Hiển thị ngày tạo -->
                        <td>@item.UpdatedDateTime.ToString("dd/MM/yyyy HH:mm")</td> <!-- Hiển thị ngày cập nhật -->
                        <td>
                            <!-- Nút chỉnh sửa sử dụng Modal -->
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editPostStatusModal"
                                    data-id="@item.Id" data-status="@item.IsActived">
                                Chỉnh sửa
                            </button>
                            <button type="button" class="btn btn-danger" onclick="deletePost(@item.Id)">Xóa</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Modal chỉnh sửa trạng thái -->
<div class="modal fade" id="editPostStatusModal" tabindex="-1" aria-labelledby="editPostStatusModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPostStatusModalLabel">Chỉnh sửa trạng thái bài đăng</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" asp-action="UpdateStatusPost" asp-controller="AdminPost">
                    <div class="mb-3">
                        <label for="PostId" class="form-label">ID Bài viết:</label>
                        <input type="text" id="PostId" name="PostId" class="form-control" readonly />
                    </div>

                    <div class="mb-3">
                        <label for="IsActived" class="form-label">Trạng thái bài viết:</label>
                        <select id="IsActived" name="IsActived" class="form-select">
                            <option value="true">Hoạt động</option>
                            <option value="false">Không hoạt động</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">Cập nhật trạng thái</button>
                </form>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script src="~/admin/js/datatable-Post.js"></script>

    <script>
        // Script để xử lý việc nạp thông tin vào modal khi người dùng nhấn nút chỉnh sửa
        const editButtons = document.querySelectorAll('[data-bs-toggle="modal"]');
        editButtons.forEach(button => {
            button.addEventListener('click', () => {
                const postId = button.getAttribute('data-id');
                const postStatus = button.getAttribute('data-status');

                // Cập nhật giá trị vào trong modal
                document.getElementById('PostId').value = postId;
                document.getElementById('IsActived').value = postStatus === 'true' ? 'true' : 'false';
            });
        });
    </script>
}
